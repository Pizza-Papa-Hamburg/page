<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Pizza Papa Hamburg – Italienische Speisen & Pizza</title>
  <meta name="description" content="Pizza Papa Hamburg: Italienische Klassiker, hausgemachter Teig, frische Saucen und schnelle Küche mit Herz.">
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;600;700&family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">

  <style>
    :root{
      --parchment:#faf6eb; --ink:#2b2a29; --deep:#173b2d; --wine:#5b2734;
      --gold:#b08d57; --shadow:0 6px 20px rgba(0,0,0,.10); --radius:0; --max:1080px;
      --green:#0f3a2f;--green2:#0a2a21;--gold2:#c9a667;
    }
    *{box-sizing:border-box} html,body{margin:0;padding:0}
    body{color:var(--ink);font-family:"Cormorant Garamond", Georgia, serif;font-size:18px;line-height:1.7;background:#e7dbc0;min-height:100%;}
    body::before{content:"";position:fixed;inset:0;z-index:-2;background:url('images/brick.jpg') center/cover no-repeat;filter:brightness(.82) saturate(.95);}
    body::after{content:"";position:fixed;inset:0;z-index:-1;background:radial-gradient(1200px 600px at 50% 0%, rgba(0,0,0,.20), transparent 60%),linear-gradient(180deg, rgba(0,0,0,.22), rgba(0,0,0,.30));mix-blend-mode:multiply;}

    .frame{border:2px solid var(--gold);border-radius:var(--radius);background:url('images/paper.jpg') repeat;background-size:auto;box-shadow:var(--shadow);}
    header.hero{min-height:60vh;background:url('images/hero.jpg') center/cover no-repeat, linear-gradient(180deg,var(--deep),var(--wine));display:flex;align-items:center;justify-content:center;text-align:center;color:#fff;position:relative;border-bottom:4px double var(--gold);}
    header.hero::after{content:"";position:absolute;inset:0;background:linear-gradient(180deg, rgba(0,0,0,.35), rgba(0,0,0,.5));}
    .hero-inner{position:relative;z-index:1;padding:36px 18px;}
    .brand{font-family:"Cinzel",serif;margin:0;font-size:44px;text-shadow:0 2px 8px rgba(0,0,0,.35)}
    .tagline{margin:.4rem 0 1rem;font-style:italic;opacity:.95}
    .cta{display:inline-block;margin-top:8px;text-decoration:none;border:2px solid var(--gold);color:var(--parchment);background:var(--deep);padding:10px 18px;border-radius:999px;font-weight:600;transition:all .3s;}
    .cta:hover{background:var(--wine);color:#fff;}
    section{padding:56px 16px} .container{max-width:var(--max);margin:0 auto}
    h2.section-title{font-family:"Cinzel",serif;text-align:center;margin:0 0 6px;font-weight:700;letter-spacing:.5px;color:var(--deep);display:inline-block;padding:8px 16px;background:rgba(255,250,240,.92);border:1px solid var(--gold);box-shadow:0 4px 14px rgba(0,0,0,.12);}
    .section-title{position:relative;left:50%;transform:translateX(-50%);} .section-sub{color:#6b5f57;text-align:center;margin:6px 0 22px;font-style:italic}

    .menu-section{margin:22px 0;padding:18px}
    .menu-title{font-family:"Cinzel",serif;color:var(--wine);margin:0 0 8px;text-align:center;font-size:24px}
    ul.menu-list{list-style:none;margin:0;padding:0}
    ul.menu-list li{display:flex;gap:10px;align-items:center;padding:10px 6px;border-bottom:1px dotted #d6c9b3}
    .name{font-weight:600}.dots{flex:1;height:2px;margin:0 6px;background-image:radial-gradient(#bda98a 1.2px, transparent 1.2px);background-size:8px 2px;background-repeat:repeat-x;background-position:center;}
    .price{white-space:nowrap;font-weight:700}

    #galerie .frame{padding-bottom:34px;}
    .gallery{display:grid;gap:16px;grid-template-columns:repeat(auto-fit, minmax(220px,1fr));margin-bottom:8px;}
    .gallery img{width:100%;height:220px;object-fit:cover;border:2px solid var(--gold);border-radius:12px;box-shadow:var(--shadow);margin-bottom:16px;}

    .hours{list-style:none;margin:16px auto 6px;padding:0;max-width:520px;font-size:.92rem;}
    .hours li{display:flex;gap:10px;align-items:flex-end;padding:6px 0;border-bottom:1px dotted #d6c9b3}
    .hours .day{min-width:130px;font-weight:600}.hours .fill{flex:1;border-bottom:1px dotted #bda98a;transform:translateY(-4px)}.hours .time{white-space:nowrap;font-weight:600}

    footer{border-top:4px double var(--gold);background:url('images/paper.jpg') center/cover repeat;color:var(--ink);text-align:center;padding:26px 16px}
    .social{display:flex;gap:16px;justify-content:center;margin-top:10px}
    .social a{display:inline-flex;align-items:center;justify-content:center;width:38px;height:38px;border:2px solid var(--gold);border-radius:999px;color:#0e1b16;text-decoration:none;transition:.25s}
    .social a:hover{background:rgba(0,0,0,.05);transform:translateY(-2px)} .social svg{width:20px;height:20px;fill:currentColor}
    .small{opacity:.85;font-size:16px}.center{text-align:center}
    .legal-links{margin-top:12px;display:flex;gap:18px;justify-content:center;flex-wrap:wrap}
    .legal-links a{color:inherit;text-decoration:underline dotted}

    /* Titel-Farben in dunklen Sektionen */
    #menu .section-title{color:#ffffff;background:none;border:none;box-shadow:none;padding:0;display:block;position:static;transform:none;text-align:center;text-shadow:0 2px 8px rgba(0,0,0,.35);}
    #menu .section-sub{color:#ffffff;opacity:.9;text-shadow:0 1px 4px rgba(0,0,0,.35);}
    #about .section-title,#galerie .section-title,#kontakt .section-title,#impressum .section-title,#datenschutz .section-title{background:none;border:none;box-shadow:none;padding:0;display:block;position:static;transform:none;text-align:center;}
    #about .section-sub{color:#2b2a29;opacity:.95;}

    /* Cookie Banner */
    .cookie-banner{position:fixed;z-index:9999;left:16px;right:16px;bottom:16px;display:none;align-items:flex-start;gap:14px;padding:14px 16px;border:2px solid var(--gold);border-radius:12px;background:url('images/paper.jpg') center/cover repeat;box-shadow:var(--shadow);}
    .cookie-actions{display:flex;gap:10px;margin-left:auto;flex-wrap:wrap}
    .btn{cursor:pointer;border:2px solid var(--gold);padding:8px 12px;border-radius:999px;background:#fff;}
    .btn.primary{background:var(--deep);color:#fff;} .btn.link{background:transparent;text-decoration:underline;}

    /* BOT */
    .ppx-launch{position:fixed;right:22px;bottom:22px;z-index:99999;display:flex;align-items:center;gap:10px;background:#fff;border-radius:999px;padding:10px 14px;border:1px solid #e7ebee;box-shadow:0 14px 36px rgba(0,0,0,.18);cursor:pointer}
    .ppx-dot{width:38px;height:38px;border-radius:50%;background:var(--green);display:grid;place-items:center;color:#fff;font-size:18px}
    .ppx-panel{position:fixed;right:22px;bottom:86px;width:480px;max-width:calc(100vw - 44px);display:none;z-index:100000;border-radius:18px;overflow:hidden;border:1px solid rgba(0,0,0,.08);box-shadow:0 28px 80px rgba(0,0,0,.35);background:var(--green2);flex-direction:column;max-height:78vh;}
    .ppx-open{display:flex;}
    .ppx-h{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;background:var(--green);color:#fff;border-bottom:1px solid rgba(0,0,0,.25)}
    .ppx-title{font-family:"Cinzel",serif;font-weight:700;letter-spacing:.3px}
    .ppx-x{border:none;background:transparent;font-size:22px;color:#fff;cursor:pointer;opacity:.9}
    .ppx-v{padding:14px;flex:1;overflow:auto;background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.02)), var(--green2);color:#f7faf8;display:flex;flex-direction:column;gap:12px;min-height:520px}
    .ppx-m{line-height:1.35;white-space:pre-wrap} .ppx-link{color:#f3e9c9;text-decoration:underline;}
    .ppx-bot{background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.18);padding:12px;border-radius:12px}
    .ppx-grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:10px;margin-top:2px}
    .ppx-opt{display:flex;align-items:center;gap:10px;border:1px solid rgba(255,255,255,.18);background:rgba(255,255,255,.06);border-radius:14px;padding:12px;cursor:pointer;transition:.15s}
    .ppx-opt:hover{transform:translateY(-1px);box-shadow:0 6px 16px rgba(0,0,0,.18)}
    .ppx-ico{width:26px;height:26px;border-radius:999px;display:grid;place-items:center;background:linear-gradient(135deg,var(--gold2),#ead09b);color:#0c1f18;font-weight:700;font-size:14px}
    .ppx-pill{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border:1px solid rgba(255,255,255,.18);background:rgba(255,255,255,.06);cursor:pointer}
    .ppx-card{border:1px solid rgba(255,255,255,.18);background:rgba(255,255,255,.06);border-radius:14px;padding:12px}
    .ppx-heading{font-family:"Cinzel",serif;margin:0 0 6px;color:#efe6d6}
    .ppx-actions{display:flex;gap:10px;margin-top:4px;flex-wrap:wrap}
    .ppx-minirow{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
    .ppx-mini{padding:8px 12px;border-radius:999px;border:1px solid rgba(255,255,255,.18);background:rgba(255,255,255,.06);cursor:pointer}
    .ppx-appear{animation:ppxFade .25s ease both;} @keyframes ppxFade{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:none}}
    @media (max-width:640px){.ppx-panel{width:auto;left:22px;right:22px;max-height:85vh}.ppx-v{min-height:60vh}}
    .ppx-opt.ppx-selected,.ppx-pill.ppx-selected{background:rgba(255,255,255,.18);border-color:rgba(255,255,255,.45);box-shadow:0 0 0 2px rgba(201,166,103,.35) inset;transform:translateY(-1px)}
    .ppx-input{display:flex;gap:8px;margin-top:8px}
    .ppx-input input,.ppx-input textarea{width:100%;padding:10px 12px;border-radius:10px;border:1px solid rgba(255,255,255,.28);background:rgba(255,255,255,.1);color:#fff;font-size:15px;outline:none;}
    .ppx-input textarea{min-height:72px;resize:vertical}
  </style>
</head>
<body>
  <header class="hero" id="top">
    <div class="hero-inner">
      <h1 class="brand">Pizza Papa Hamburg</h1>
      <p class="tagline">Italienische Klassiker – schnell, herzlich, mit Charakter.</p>
      <a class="cta" href="#kontakt">Jetzt anrufen / reservieren</a>
    </div>
  </header>

  <!-- ABOUT -->
  <section id="about">
    <div class="container frame">
      <h2 class="section-title">Unsere Philosophie</h2>
      <p class="section-sub">Traditionelle Rezepte, ehrliche Zutaten, freundschaftliche Atmosphäre.</p>
      <p class="center">Echte italienische Pizza – hausgemachter Teig, frische Saucen, schnelle Zubereitung im Steinofen.</p>
    </div>
  </section>

  <!-- MENU (gekürzt – reiner Inhalt, keine Logik) -->
  <section id="menu">
    <div class="container">
      <h2 class="section-title">Speisekarte</h2>
      <p class="section-sub">Alle Preise sind Platzhalter (XX/YY/ZZ).</p>

      <div class="menu-section frame">
        <h3 class="menu-title">Pizza</h3>
        <ul class="menu-list">
          <li><span class="name">Margherita</span><span class="dots"></span><span class="price">XX €</span></li>
          <li><span class="name">Prosciutto e Funghi</span><span class="dots"></span><span class="price">XX €</span></li>
          <li><span class="name">Diavola (pikant)</span><span class="dots"></span><span class="price">YY €</span></li>
        </ul>
      </div>

      <div class="menu-section frame">
        <h3 class="menu-title">Pasta</h3>
        <ul class="menu-list">
          <li><span class="name">Pomodoro</span><span class="dots"></span><span class="price">XX €</span></li>
          <li><span class="name">Carbonara</span><span class="dots"></span><span class="price">YY €</span></li>
        </ul>
      </div>
    </div>
  </section>

  <!-- GALERIE -->
  <section id="galerie">
    <div class="container frame">
      <h2 class="section-title">Galerie</h2>
      <div class="gallery">
        <img src="images/gallery1.jpg" alt="Pizza">
        <img src="images/gallery2.jpg" alt="Pasta">
        <img src="images/gallery3.jpg" alt="Calzone">
        <img src="images/gallery4.jpg" alt="Dessert">
      </div>
    </div>
  </section>

  <!-- KONTAKT (statischer Block) -->
  <section id="kontakt">
    <div class="container frame">
      <h2 class="section-title">Reservierung & Kontakt</h2>
      <div class="section-sub">Beispieldaten – später ersetzen.</div>
      <p class="center">
        Telefon: <strong>+49 40 1234567</strong><br>
        WhatsApp: <strong>+49 40 1234567</strong><br>
        Adresse: <strong>Muster Str. XX, YYYYY Musterstadt</strong>
      </p>
      <ul class="hours">
        <li><span class="day">Mo–Fr</span><span class="fill"></span><span class="time">11:00 – 22:00 Uhr</span></li>
        <li><span class="day">Sa</span><span class="fill"></span><span class="time">13:00 – 24:00 Uhr</span></li>
        <li><span class="day">So</span><span class="fill"></span><span class="time">15:00 – 21:00 Uhr</span></li>
      </ul>
      <p class="center" style="margin-top:18px"><a class="cta" href="#top">Nach oben</a></p>
    </div>
  </section>

  <!-- IMPRESSUM / DATENSCHUTZ (gekürzt) -->
  <section id="impressum"><div class="container frame"><h2 class="section-title">Impressum</h2><p class="center small">Muster-Angaben …</p></div></section>
  <section id="datenschutz"><div class="container frame"><h2 class="section-title">Datenschutz</h2><p class="small">Kurzer Datenschutztext …</p></div></section>

  <footer>
    <p>&copy; 2025 Pizza Papa Hamburg</p>
    <div class="legal-links">
      <a href="#impressum">Impressum</a>
      <a href="#datenschutz">Datenschutz</a>
      <a href="#" onclick="resetConsent();return false;">Cookie-Einstellungen</a>
    </div>
  </footer>

  <!-- Cookie Banner -->
  <div class="cookie-banner" id="cookieBanner" role="dialog" aria-live="polite" aria-label="Cookie-Hinweis">
    <p><strong>Cookie-Hinweis:</strong> Wir verwenden keine Tracking-Cookies. Wir speichern nur Ihre Auswahl lokal auf Ihrem Gerät.</p>
    <div class="cookie-actions">
      <button class="btn primary" onclick="acceptCookies()">Einverstanden</button>
      <button class="btn" onclick="declineCookies()">Ablehnen</button>
      <a class="btn link" href="#datenschutz">Mehr erfahren</a>
    </div>
  </div>

  <!-- EmailJS -->
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

  <!-- Launcher -->
  <div class="ppx-launch" id="ppx-launch" role="button" aria-label="Schnellzugriff öffnen">
    <div>Reservieren &amp; mehr ✨</div><div class="ppx-dot">💬</div>
  </div>

  <!-- Panel -->
  <div class="ppx-panel" id="ppx-panel" aria-live="polite">
    <div class="ppx-h">
      <div class="ppx-title">Pizza Papa Hamburg</div>
      <button class="ppx-x" id="ppx-close" aria-label="Chat schließen">×</button>
    </div>
    <div class="ppx-v" id="ppx-v"></div>
    <div class="ppx-brandbar">Powered by <strong>AI Elements</strong> ✨</div>
  </div>

  <script>
  /* ---------- Cookie-Banner ---------- */
  (function(){
    const KEY='pp-consent';
    const banner=document.getElementById('cookieBanner');
    try{ if(!localStorage.getItem(KEY)){ banner.style.display='flex'; } }catch(e){ banner.style.display='flex'; }
    window.acceptCookies=function(){ try{ localStorage.setItem(KEY,'accepted'); }catch(e){} banner.remove(); };
    window.declineCookies=function(){ try{ localStorage.setItem(KEY,'declined'); }catch(e){} banner.remove(); };
    window.resetConsent=function(){ try{ localStorage.removeItem(KEY); }catch(e){} location.hash='#datenschutz'; location.reload(); };
  })();

  /* ---------- Bot ---------- */
  (function(){
    // *** NEUER PUBLIC KEY ***
    emailjs.init({ publicKey: 'J1KTj7-7VJBsV-LHc' });

    const CFG = {
      brand: "Pizza Papa Hamburg",
      email: "pizza.papa.hamburg@outlook.de",
      OPEN: {1:["11:00","22:00"],2:["11:00","22:00"],3:["11:00","22:00"],4:["11:00","22:00"],5:["11:00","22:00"],6:["13:00","24:00"],0:["15:00","21:00"]},
      BUCKETS: { mittag:["12:00","17:30"], frueh:["18:00","20:30"], spaet:["21:00","23:59"] },
      EMAIL:{
        service:"service_ais7v5f",
        toTemplate:"template_m5baprd",       // Restaurant
        autoReplyTemplate:"template_hnwo39i" // Gast (To Email = {{to_email}})
      }
    };

    const panel = document.getElementById('ppx-panel');
    const view  = document.getElementById('ppx-v');
    document.getElementById('ppx-launch').onclick=()=>{ panel.classList.add('ppx-open'); if(!view.childElementCount) start(); };
    document.getElementById('ppx-close').onclick =()=>{ panel.classList.remove('ppx-open'); view.innerHTML=''; };

    const el=(t,c,h)=>{const n=document.createElement(t); if(c)n.className=c; if(h!=null)n.innerHTML=h; return n;};
    const msg=h=>view.append(el('div','ppx-m ppx-bot ppx-appear',h));
    const wait=ms=>new Promise(r=>setTimeout(r,ms));
    const DELAY={short:300,medium:600};

    const pad=n=>String(n).padStart(2,'0');
    const hmToMin=s=>{const [h,m]=(s||'').split(':').map(Number); return h*60+(m||0);}
    const minToHm=m=>`${pad(Math.floor(m/60))}:${pad(m%60)}`
    const fmtDate=d=>`${pad(d.getDate())}.${pad(d.getMonth()+1)}.${d.getFullYear()}`
    const twoHoursFromNow=()=>new Date(Date.now()+2*60*60*1000);

    function slotsForDay(date,bucketKey){
      const open=CFG.OPEN[date.getDay()]; if(!open) return [];
      const [oS,oE]=open.map(hmToMin);
      const [bS,bE]=CFG.BUCKETS[bucketKey].map(hmToMin);
      let s=Math.max(oS,bS), e=Math.min(oE,bE); if(e-s<30) return [];
      const out=[], now2=twoHoursFromNow();
      for(let m=s;m<=e;m+=30){ const slot=new Date(date); slot.setHours(Math.floor(m/60),m%60,0,0); if(slot>=now2 || slot.toDateString()!=new Date().toDateString()) out.push(minToHm(m)); }
      return out;
    }

    async function askDate(){
      const box=el('div','ppx-card ppx-appear'); const d=new Date();
      const min=`${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}`;
      box.innerHTML=`<h4 class="ppx-heading">Datum wählen</h4>
        <div class="ppx-input"><input id="ppx-date" type="date" min="${min}"></div>
        <div class="ppx-actions"><div class="ppx-pill" id="ok">Weiter →</div></div>`;
      view.append(box);
      return new Promise(res=> box.querySelector('#ok').onclick=()=>{
        const v=box.querySelector('#ppx-date').value; if(!v) return alert('Bitte Datum wählen.');
        const [y,m,dd]=v.split('-').map(Number); res(new Date(y,m-1,dd));
      });
    }
    async function askBucket(){ 
      const box=el('div','ppx-card ppx-appear'); 
      box.innerHTML=`<h4 class="ppx-heading">Tageszeit wählen</h4>
        <div class="ppx-grid">
          <div class="ppx-opt" data-k="mittag"><span class="ppx-ico">☀️</span><span>Mittag</span></div>
          <div class="ppx-opt" data-k="frueh"><span class="ppx-ico">🌆</span><span>Früher Abend</span></div>
          <div class="ppx-opt" data-k="spaet"><span class="ppx-ico">🌙</span><span>Später Abend</span></div>
        </div>`;
      view.append(box);
      return new Promise(res=> box.querySelectorAll('.ppx-opt').forEach(b=> b.onclick=()=>res(b.dataset.k)));
    }
    async function askTime(date,bucket){
      const times=slotsForDay(date,bucket);
      const box=el('div','ppx-card ppx-appear'); box.innerHTML=`<h4 class="ppx-heading">Uhrzeit wählen</h4>`; view.append(box);
      const grid=el('div','ppx-grid'); view.append(grid);
      return new Promise(res=>{
        if(times.length===0) { msg('<div class="ppx-card">Keine Slots in dieser Tageszeit.</div>'); return res(null); }
        times.forEach(t=>{ const b=el('div','ppx-opt',`<span class="ppx-ico">🕒</span><span>${t} Uhr</span>`); b.onclick=()=>res(t); grid.appendChild(b); });
      });
    }
    async function askNumber(){ 
      const box=el('div','ppx-card ppx-appear'); box.innerHTML=`<h4 class="ppx-heading">Wie viele Personen?</h4>
        <div class="ppx-input"><input id="n" type="number" min="1" value="1"></div>
        <div class="ppx-actions"><div class="ppx-pill" id="ok">Weiter →</div></div>`;
      view.append(box);
      return new Promise(res=> box.querySelector('#ok').onclick=()=>{ const v=+box.querySelector('#n').value; if(v<1||!Number.isFinite(v)) return alert('Bitte Zahl ≥ 1.'); res(v); });
    }
    async function askText(label, ph){ 
      const box=el('div','ppx-card ppx-appear'); box.innerHTML=`<h4 class="ppx-heading">${label}</h4>
        <div class="ppx-input"><input id="t" type="text" placeholder="${ph||''}"></div>
        <div class="ppx-actions"><div class="ppx-pill" id="ok">Weiter →</div></div>`;
      view.append(box);
      return new Promise(res=> box.querySelector('#ok').onclick=()=>{ const v=box.querySelector('#t').value.trim(); if(!v) return alert('Bitte ausfüllen.'); res(v); });
    }
    async function askPhone(){ 
      const box=el('div','ppx-card ppx-appear'); box.innerHTML=`<h4 class="ppx-heading">Telefon (optional)</h4>
        <div class="ppx-input"><input id="p" type="tel" placeholder="+49 …"></div>
        <div class="ppx-actions"><div class="ppx-pill" id="ok">Weiter →</div><div class="ppx-pill" id="skip">Ohne Telefon</div></div>`;
      view.append(box);
      const valid=v=>/^[+()\s\-0-9]{6,}$/.test(v||"");
      return new Promise(res=>{
        box.querySelector('#ok').onclick=()=>{ const v=box.querySelector('#p').value.trim(); if(!valid(v)) return alert('Bitte gültige Nummer oder „Ohne Telefon“.'); res(v); };
        box.querySelector('#skip').onclick=()=>res('');
      });
    }
    async function askEmail(){ 
      const box=el('div','ppx-card ppx-appear'); box.innerHTML=`<h4 class="ppx-heading">E-Mail für Bestätigung</h4>
        <div class="ppx-input"><input id="e" type="email" placeholder="name@example.com"></div>
        <div class="ppx-actions"><div class="ppx-pill" id="ok">Weiter →</div></div>`;
      view.append(box);
      const valid=v=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v||"");
      return new Promise(res=> box.querySelector('#ok').onclick=()=>{ const v=box.querySelector('#e').value.trim(); if(!valid(v)) return alert('Bitte gültige E-Mail.'); res(v); });
    }
    async function askTextarea(label,ph){ 
      const box=el('div','ppx-card ppx-appear'); box.innerHTML=`<h4 class="ppx-heading">${label}</h4>
        <div class="ppx-input"><textarea id="a" placeholder="${ph||''}"></textarea></div>
        <div class="ppx-actions"><div class="ppx-pill" id="ok">Weiter →</div></div>`;
      view.append(box); return new Promise(res=> box.querySelector('#ok').onclick=()=>res(box.querySelector('#a').value.trim()));
    }

    async function flow(){
      view.innerHTML='';
      msg('Perfekt – lass uns einen Tisch klarmachen:'); await wait(DELAY.medium);
      const d  = await askDate();        if(!d) return;
      const bk = await askBucket();      if(!bk) return;
      const t  = await askTime(d,bk);    if(!t) return;
      const n  = await askNumber();      if(!n) return;
      const nm = await askText('Dein Name','Vor- und Nachname'); if(!nm) return;
      const ph = await askPhone();       if(ph===undefined) return;
      const em = await askEmail();       if(!em) return;
      const wi = await askTextarea('Wünsche (optional)','Kinderstuhl, Allergien, Anlass …');

      const dateStr = fmtDate(d);
      const summary = el('div','ppx-card ppx-appear',`
        <h4 class="ppx-heading">Zusammenfassung</h4>
        <div><strong>Datum:</strong> ${dateStr}</div>
        <div><strong>Uhrzeit:</strong> ${t} Uhr</div>
        <div><strong>Personen:</strong> ${n}</div>
        <div><strong>Name:</strong> ${nm}</div>
        <div><strong>Telefon:</strong> ${ph||'–'}</div>
        <div><strong>E-Mail:</strong> ${em}</div>
        ${wi?`<div><strong>Wünsche:</strong> ${wi}</div>`:''}
      `);
      view.append(summary);

      const controls = el('div','ppx-actions ppx-appear');
      const sendBtn  = el('div','ppx-pill','✉️ Anfrage senden');
      controls.append(sendBtn); view.append(controls);

      sendBtn.onclick = async () => {
        sendBtn.textContent='Sende…'; sendBtn.style.pointerEvents='none';

        const payload = {
          date: dateStr, time: `${t} Uhr`, persons: String(n),
          name: nm, from_name: nm,
          phone: ph || 'keine Angabe',
          email: em, reply_to: em,
          message: wi || ''
        };
        console.log('EmailJS payload:', payload);

        let ok=false;
        try{
          await emailjs.send(CFG.EMAIL.service, CFG.EMAIL.toTemplate, payload); // Restaurant
          ok=true;
        }catch(e){ console.error('EmailJS Restaurant:', e && e.text ? e.text : e); }

        if(ok){
          // Gast (Fehler nur loggen)
          try{
            await emailjs.send(CFG.EMAIL.service, CFG.EMAIL.autoReplyTemplate, { ...payload, to_email: em, to_name: nm });
          }catch(e){ console.warn('EmailJS Gast:', e && e.text ? e.text : e); }

          msg('<div class="ppx-card">Super! Die Anfrage wurde gesendet. 📧</div>');
        }else{
          msg('<div class="ppx-card">Ups – das hat leider nicht geklappt. Bitte versuch es später erneut oder nutze <a class="ppx-link" href="mailto:'+CFG.email+'">E-Mail</a>.</div>');
        }
        sendBtn.textContent='✉️ Anfrage senden'; sendBtn.style.pointerEvents='';
      };
    }

    function start(){
      msg(`<div class="ppx-heading">👋 Willkommen bei Pizza Papa Hamburg!</div><div>Wie können wir dir helfen?</div>`);
      const grid=el('div','ppx-grid ppx-appear');
      const b1=el('div','ppx-opt',`<span class="ppx-ico">📅</span><span>Reservieren</span>`); b1.onclick=flow;
      const b2=el('div','ppx-opt',`<span class="ppx-ico">🍽</span><span>Speisekarte</span>`); b2.onclick=()=>msg('<div class="ppx-card">Speisekarte siehe oben 😊</div>');
      grid.append(b1,b2); view.append(grid);
    }
  })();
  </script>
</body>
</html>
